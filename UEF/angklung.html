<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LocalMY</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f6f6f6;
      width: 100%;
    }

    /* Top Bar */
    .top-bar {
      background: #000;
      color: #fff;
      font-size: 13px;
      padding: 6px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .top-bar a { color: #fff; text-decoration: none; margin: 0 6px; }
    .top-left, .top-right { display: flex; align-items: center; }
    .top-left a:hover, .top-right a:hover { text-decoration: underline; }

    /* Header */
    header {
      background: #000;
      color: #fff;
      padding: 15px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .logo { display: flex; align-items: center; font-size: 24px; font-weight: bold; }
    .logo span { margin-left: 5px; }
    .search-bar { flex: 1; margin: 0 30px; display: flex; }
    .search-bar input { width: 100%; padding: 10px; border: none; border-radius: 3px 0 0 3px; }
    .search-bar button { background: #000; border: none; padding: 10px 15px; color: #fff; border-radius: 0 3px 3px 0; cursor: pointer; }
    .icons { font-size: 22px; cursor: pointer; position: relative; }
    .cart-count { background: yellow; color: black; font-size: 12px; padding: 2px 6px; border-radius: 50%; position: absolute; top: -8px; right: -8px; }

    /* Category Bar */
    .category-bar {
      background: #000;
      color: #fff;
      font-size: 14px;
      padding: 8px 20px;
      display: flex;
      gap: 20px;
      overflow-x: auto;
      justify-content: center;
    }
    .category-bar a { color: #fff; text-decoration: none; white-space: nowrap; }
    .category-bar a:hover { text-decoration: underline; }

    /* Products */
    .products {
      padding: 20px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 15px;
      max-width: 1000px;
      margin: auto;
    }
    .product-card {
      background: #fff;
      border-radius: 8px;
      padding: 15px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      text-align: center;
    }
    .product-card img { max-width: 100%; border-radius: 5px; height:300px; }
    .product-card h3 { font-size: 18px; margin: 10px 0 5px; }
    .product-card p { color: #000; font-weight: bold; }
    .product-card button { background: #000; color: #fff; border: none; padding: 8px 12px; margin-top: 8px; cursor: pointer; border-radius: 5px; }

    /* Cart Dropdown */
    .cart-dropdown {
      display: none;
      position: absolute;
      right: 20px;
      top: 70px;
      background: #0d1117;
      width: 320px;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
      padding: 20px;
      z-index: 999;
      color: #fff;
    }
    #cartItems {
      max-height: 250px;
      overflow-y: auto;
      padding-right: 5px;
    }
    .cart-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 8px;
    }
    .cart-item span {
      flex: 1;
      margin-left: 8px;
    }
    .cart-summary p {
      display: flex;
      justify-content: space-between;
      margin: 5px 0;
    }
    .checkout-btn {
      margin-top: 10px;
      background: #00c853;
      color: white;
      font-weight: bold;
      border: none;
      padding: 10px;
      width: 100%;
      border-radius: 8px;
      cursor: pointer;
    }
    .clear-btn {
      margin-top: 10px;
      background: transparent;
      color: #fff;
      border: 1px solid #444;
      padding: 10px;
      width: 100%;
      border-radius: 8px;
      cursor: pointer;
    }
    .remove-btn {
      background: black;
      color: red;
      border: none;
      border-radius: 4px;
      padding: 5px 8px;
      cursor: pointer;
      font-size: 14px;
      margin-left: 10px;
    }
    .remove-btn:hover {
      background: #333;
      color: #ff4d4d;
    }


    /* Reviews Layout */
    .reviews-section {
      max-width: 1000px;
      margin: 40px auto;
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .reviews-header { display: grid; grid-template-columns: 200px 1fr; gap: 20px; }
    .avg-rating { font-size: 36px; font-weight: bold; }
    .stars { color: gold; }
    .distribution .bar { height: 8px; background: #eee; border-radius: 4px; overflow: hidden; }
    .distribution .bar span { display: block; height: 100%; background: gold; }
    .review-card {
      border: 1px solid #eee;
      border-radius: 8px;
      padding: 10px;
      margin-top: 12px;
    }
    .review-head { display: flex; align-items: center; justify-content: space-between; gap: 10px; }
    .avatar { width: 32px; height: 32px; border-radius: 50%; background: #ddd; display: flex; align-items: center; justify-content: center; font-weight: bold; }
    .review-meta { font-size: 12px; color: #666; }
    .buttons { margin: 10px 0; }
    .buttons button { margin-right: 10px; background: #000; color: #fff; border: none; padding: 6px 10px; border-radius: 4px; cursor: pointer; }
  </style>
</head>
<body>

  <!-- Top Bar -->
  <div class="top-bar">
    <div class="top-left">
      <a href="#">Seller Centre</a> | <a href="#">Start Selling</a> | <a href="#">Download</a> | <a href="#">Follow us</a>
    </div>
    <div class="top-right">
      <a href="#">üîî Notifications</a> | <a href="#">‚ùì Help</a> | <a href="#">üåê English ‚ñº</a> | <a href="index.html">Login</a>
    </div>
  </div>

  <!-- Main Header -->
  <header>
  <div class="logo">
    <a href="mainpage.html" style="text-decoration:none; color:inherit;">üõç <span>LocalMY</span></a>
  </div>
    <div class="search-bar">
      <input type="text" placeholder="Sign Up & Get RM25 Off Voucher!">
      <button>üîç</button>
    </div>
    <div class="icons" id="cart">
      üõí <span class="cart-count" id="cartCount">0</span>
    </div>
  </header>

  <!-- Cart Dropdown -->
  <div class="cart-dropdown" id="cartDropdown">
    <h3>Your Cart</h3>
    <div id="cartItems"></div>

    <div style="margin:10px 0;">
      <select id="shippingMethod">
        <option>Standard Shipping</option>
        <option>Express Shipping</option>
      </select>
      <input type="text" id="promoCode" placeholder="Promo code (e.g. SAVE10)">
    </div>

    <div class="cart-summary">
      <p>Subtotal <span id="subtotal">$0.00</span></p>
      <p>Shipping <span id="shipping">$0.00</span></p>
      <p>Discount <span id="discount">‚Äì $0.00</span></p>
      <p><strong>Total <span id="cartTotal">$0.00</span></strong></p>
    </div>

    <button class="checkout-btn" onclick="window.location.href='checkout.html'">Checkout</button>
    <button class="clear-btn" onclick="clearCart()">Clear cart</button>
    <p style="font-size:12px; color:gray;">Test page ‚Äî no real payment processed.</p>
  </div>

  <!-- Category Bar -->
  <div class="category-bar">
    <a href="#">Foodies</a>
    <a href="#">Clothes</a>
    <a href="#">Biskut Murah Giler</a>
    <a href="#">Instruments</a>
    <a href="#">Tumbler</a>
    <a href="#">Bag</a>
    <a href="#">Shoes</a>
    <a href="#">More...</a>
  </div>

  <!-- Products -->
  <section class="products">
    <div class="product-card">
      <img src="angklung.jpg" alt="Angklung">
      <h3>Angklung</h3>
      <p>RM215.00</p>
      <button onclick="addToCart('Angklung', 215.00, 'angklung.jpg')">Add to Cart</button>
    </div>
  </section>

  <!-- Reviews -->
  <section class="reviews-section">
    <h2>Customer Reviews (<span id="reviewsCount">0</span>)</h2>
    <div class="reviews-header">
      <div>
        <div class="avg-rating" id="avgRating">0.0</div>
        <div id="avgStars" class="stars"></div>
      </div>
      <div class="distribution" id="dist"></div>
    </div>
    <div class="buttons">
      <button id="shuffleBtn">üîÑ Shuffle Reviews</button>
      <button id="addReviewBtn">‚ûï Add Random Review</button>
    </div>
    <div id="reviewsList"></div>
  </section>

  <template id="starTpl"><span style="font-size:16px;">‚òÖ</span></template>

  <script>
    // --- CART ---
    let cart = [];
    const cartCount = document.getElementById("cartCount");
    const cartItems = document.getElementById("cartItems");
    const cartTotal = document.getElementById("cartTotal");
    const cartDropdown = document.getElementById("cartDropdown");
    const cartIcon = document.getElementById("cart");
    function addToCart(name, price, image) { cart.push({ name, price, image }); updateCart(); }
    function updateCart() {
      if (!cart.length) { cartItems.innerHTML = `<p>Your cart is empty.</p>`; cartTotal.textContent="Total: RM0"; cartCount.textContent="0"; return;}
      cartCount.textContent = cart.length; cartItems.innerHTML = ""; let total=0;
      cart.forEach((item,i)=>{ total+=item.price; cartItems.innerHTML+=`<div class="cart-item"><img src="${item.image}" style="width:40px;height:40px;object-fit:cover;border-radius:5px;"><span>${item.name} - RM${item.price}</span><button class="remove-btn" onclick="removeFromCart(${i},event)">‚ùå</button></div>`; });
      cartTotal.textContent="Total: RM"+total;
    }
    function removeFromCart(i,e){if(e)e.stopPropagation();cart.splice(i,1);updateCart();}
    cartIcon.addEventListener("click",()=>{cartDropdown.style.display=cartDropdown.style.display==="block"?"none":"block";});
    document.addEventListener("click",e=>{if(!cartIcon.contains(e.target)&&!cartDropdown.contains(e.target)){cartDropdown.style.display="none";}});

    // --- REVIEWS ---
    const NAMES=["Aisha","Ben","Chloe","Danish","Elena","Faiz","Grace","Haris","Isla","Jasper","Khairi","Liam","Maya","Noah","Olivia","Priya","Rina","Sara","Theo","Xin","Yara","Zara"];
    const SNIPPETS=["Battery lasts all day.","Super comfy for long calls.","Pairs instantly with my phone.","Great build quality.","Blocks noise well.","Mic is clear.","Surprisingly light.","Controls are intuitive.","Would buy again.","Gifted it‚Äîbig hit!"];
    const rand=(a,b)=>Math.floor(Math.random()*(b-a+1))+a, sample=a=>a[rand(0,a.length-1)], daysAgo=n=>{const d=new Date();d.setDate(d.getDate()-n);return d;}, niceDate=d=>d.toLocaleDateString(undefined,{month:'short',day:'numeric'});
    function randomRating(){const r=Math.random();if(r<0.6)return 5;if(r<0.9)return 4;if(r<0.97)return 3;if(r<0.995)return 2;return 1;}
    function makeReview(){return{name:sample(NAMES),rating:randomRating(),text:sample(SNIPPETS),date:daysAgo(rand(0,90)),verified:Math.random()>0.2};}
    let REVIEWS=Array.from({length:8},makeReview);
    const reviewsList=document.getElementById("reviewsList"),reviewsCount=document.getElementById("reviewsCount"),avgDisplay=document.getElementById("avgRating"),avgStars=document.getElementById("avgStars"),dist=document.getElementById("dist");
    function renderStars(c,r){c.innerHTML="";for(let i=1;i<=5;i++){const s=document.getElementById("starTpl").content.firstElementChild.cloneNode(true);s.style.color=i<=r?"gold":"#ccc";c.appendChild(s);}}
    function recomputeMeta(){const counts=[0,0,0,0,0,0];REVIEWS.forEach(r=>counts[r.rating]++);const total=REVIEWS.length,sum=REVIEWS.reduce((a,b)=>a+b.rating,0),avg=total?sum/total:0;avgDisplay.textContent=avg.toFixed(1);reviewsCount.textContent=total;renderStars(avgStars,Math.round(avg));dist.innerHTML="";for(let s=5;s>=1;s--){const row=document.createElement("div");row.style.display="grid";row.style.gridTemplateColumns="16px 1fr 24px";row.style.gap="6px";const label=document.createElement("div");label.textContent=s;const bar=document.createElement("div");bar.className="bar";const fill=document.createElement("span");fill.style.width=total?(counts[s]/total*100)+"%":"0%";bar.appendChild(fill);const count=document.createElement("div");count.textContent=counts[s];row.append(label,bar,count);dist.appendChild(row);}}
    function renderReviews(){reviewsList.innerHTML="";REVIEWS.slice().sort((a,b)=>b.date-a.date).forEach(r=>{const card=document.createElement("div");card.className="review-card";const head=document.createElement("div");head.className="review-head";const av=document.createElement("div");av.className="avatar";av.textContent=r.name[0];const who=document.createElement("div");who.innerHTML=`<div style="font-weight:700">${r.name}</div><div class="review-meta">${niceDate(r.date)} ‚Ä¢ ${r.verified?"Verified purchase":"Guest"}</div>`;const stars=document.createElement("div");stars.className="stars";renderStars(stars,r.rating);head.append(av,who,stars);const body=document.createElement("div");body.textContent=r.text;body.style.marginTop="6px";card.append(head,body);reviewsList.appendChild(card);});recomputeMeta();}
    document.getElementById("shuffleBtn").onclick=()=>{REVIEWS=Array.from({length:rand(6,12)},makeReview);renderReviews();};
    document.getElementById("addReviewBtn").onclick=()=>{REVIEWS.push(makeReview());renderReviews();};
    renderReviews();

    window.onload = () => {
      const savedCart = JSON.parse(localStorage.getItem("cart")) || [];
      cart = savedCart;
      updateCart();
    };
    window.onbeforeunload = () => {
      localStorage.setItem("cart", JSON.stringify(cart));
    };


  </script>
</body>
</html>
